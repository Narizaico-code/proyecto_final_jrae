<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Servicios</title>
    <link rel="stylesheet" href="https://unpkg.com/primeflex@latest/primeflex.css"/>
    <style>
        body {
            background-color: #F2F2F2;
            font-family: "Segoe UI", Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        .card {
            background-color: #FFFFFF;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin: 1rem;
        }

        h3 {
            color: #400C0C;
            text-align: center;
            margin-bottom: 1rem;
        }

        /* Menú superior */
        .ui-menubar {
            background-color: #400C0C !important;
            border: none !important;
            border-radius: 8px;
        }
        .ui-menubar .ui-menuitem-link {
            color: #F2F2F2 !important;
            font-weight: bold;
        }
        .ui-menubar .ui-menuitem-link:hover {
            background-color: #591D1D !important;
        }

        /* Botones */
        .ui-button-primary {
            background-color: #400C0C !important;
            border: none !important;
            color: #F2F2F2 !important;
            font-weight: bold;
            border-radius: 6px;
        }
        .ui-button-primary:hover {
            background-color: #591D1D !important;
        }
        .ui-button-danger {
            background-color: #A66F6F !important;
            border: none !important;
            color: #F2F2F2 !important;
            border-radius: 6px;
        }
        .ui-button-danger:hover {
            background-color: #591D1D !important;
        }
        .ui-button-secondary {
            background-color: #D9BFBF !important;
            border: none !important;
            color: #400C0C !important;
            border-radius: 6px;
        }

        /* DataTable */
        .ui-datatable thead th {
            background-color: #591D1D !important;
            color: #F2F2F2 !important;
            font-weight: bold;
        }
        .ui-datatable tbody td {
            background-color: #FFFFFF;
            color: #400C0C;
        }
        .ui-datatable tbody tr:nth-child(even) td {
            background-color: #F2F2F2;
        }

        /* Diálogo */
        .ui-dialog .ui-dialog-titlebar {
            background-color: #400C0C !important;
            color: #F2F2F2 !important;
            font-weight: bold;
        }
    </style>
</h:head>
<h:body>
    <div class="card">
        <h:form id="formulario-servicios">
            <p:growl id="mensaje_emergente" showDetail="true"/>

            <div class="card">
                <p:menubar>
                    <p:menuitem value="Inicio" icon="pi pi-fw pi-home"
                                actionListener="#{servicioControllerWeb.cargarDatos}"
                                update=":formulario-servicios:tabla-servicio"
                    onclick="window.location.href='menu.xhtml';return false;"/>
                    <p:menuitem value="Nuevo servicio" icon="pi pi-fw pi-plus"
                                actionListener="#{servicioControllerWeb.agregarServicio}"
                                update=":formulario-modal:ventana-servicio"
                                oncomplete="PF('ventanaModalServicio').show()"/>
                </p:menubar>
            </div>

            <div class="card">
                <p:dataTable value="#{servicioControllerWeb.servicios}"
                             var="srv" id="tabla-servicio"
                             widgetVar="tablaServicios">
                    <f:facet name="header">
                        <h3>CarWashito, Servicios</h3>
                    </f:facet>

                    <p:column headerText="ID" filterBy="#{srv.codigo()}"><h:outputText value="#{srv.codigo()}"/></p:column>
                    <p:column headerText="NOMBRE" filterBy="#{srv.name()}"><h:outputText value="#{srv.name()}"/></p:column>
                    <p:column headerText="DESCRIPCIÓN" filterBy="#{srv.description()}"><h:outputText value="#{srv.description()}"/></p:column>
                    <p:column headerText="PRECIO" filterBy="#{srv.price()}"><h:outputText value="#{srv.price()}"/></p:column>

                    <p:column headerText="OPCIONES">
                        <p:commandButton value="Editar" icon="pi pi-pencil" class="ui-button-primary"
                                         update=":formulario-modal:ventana-servicio"
                                         actionListener="#{servicioControllerWeb.prepararEdicion(srv)}"
                                         oncomplete="PF('ventanaModalServicio').show()"/>
                        <p:commandButton value="Eliminar" icon="pi pi-trash" class="ui-button-danger"
                                         actionListener="#{servicioControllerWeb.eliminarServicio}"
                                         update=":formulario-servicios:tabla-servicio :formulario-servicios:mensaje_emergente">
                            <f:setPropertyActionListener value="#{srv}" target="#{servicioControllerWeb.servicioSeleccionado}"/>
                        </p:commandButton>
                    </p:column>
                </p:dataTable>
            </div>
        </h:form>

        <h:form id="formulario-modal">
            <p:dialog header="Detalle del Servicio" showEffect="fade"
                      modal="true" widgetVar="ventanaModalServicio" responsive="true">
                <p:outputPanel id="ventana-servicio" class="ui-fluid">
                    <div class="field">
                        <p:outputLabel for="nombre">NOMBRE *</p:outputLabel>
                        <p:inputText id="nombre" value="#{servicioControllerWeb.servicioView.name}"
                                     required="true" requiredMessage="Nombre es obligatorio"/>
                    </div>
                    <div class="field">
                        <p:outputLabel for="descripcion">DESCRIPCIÓN *</p:outputLabel>
                        <p:inputTextarea id="descripcion" value="#{servicioControllerWeb.servicioView.description}"
                                         autoResize="true" required="true" requiredMessage="Descripción es obligatoria"/>
                    </div>
                    <div class="field">
                        <p:outputLabel for="precio">PRECIO *</p:outputLabel>
                        <p:inputNumber id="precio" value="#{servicioControllerWeb.servicioView.price}"
                                       required="true" requiredMessage="Precio es obligatorio"
                                       minValue="0.01" decimalPlaces="2"/>
                    </div>
                </p:outputPanel>

                <f:facet name="footer">
                    <p:commandButton value="Guardar" icon="pi pi-check" class="ui-button-primary"
                                     actionListener="#{servicioControllerWeb.guardarServicio}"
                                     update=":formulario-servicios:tabla-servicio :formulario-servicios:mensaje_emergente"
                                     oncomplete="if(#{servicioControllerWeb.mensajeError == null}) {PF('ventanaModalServicio').hide();}"/>
                    <p:commandButton value="Cancelar" icon="pi pi-times" class="ui-button-secondary"
                                     onclick="PF('ventanaModalServicio').hide()" type="button"/>
                </f:facet>
            </p:dialog>
        </h:form>
    </div>
</h:body>
</html>